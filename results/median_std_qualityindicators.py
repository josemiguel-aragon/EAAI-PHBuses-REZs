import pandas as pd
from scipy.stats import wilcoxon


if __name__ == '__main__':
    print("#############")
    print("COEV SYNC")
    df = pd.read_csv("QualityIndicatorSummary_sync.csv")
    print()
    print("HV")
    print(df[df['IndicatorName'] == "HV"]["IndicatorValue"].median())
    print(df[df['IndicatorName'] == "HV"]["IndicatorValue"].std())
    print()
    print("GD")
    print(df[df['IndicatorName'] == "GD"]["IndicatorValue"].median())
    print(df[df['IndicatorName'] == "GD"]["IndicatorValue"].std())
    print()
    print("EP")
    print(df[df['IndicatorName'] == "EP"]["IndicatorValue"].median())
    print(df[df['IndicatorName'] == "EP"]["IndicatorValue"].std())
    print()

    print()
    print("Time")
    print(df[df['IndicatorName'] == "Time"]["IndicatorValue"].mean())
    print(df[df['IndicatorName'] == "Time"]["IndicatorValue"].std())
    print()

    print("#############")
    print("COEV ASYNC")
    df2 = pd.read_csv("QualityIndicatorSummary_async.csv")
    print()
    print("HV")
    print(df2[df2['IndicatorName'] == "HV"]["IndicatorValue"].median())
    print(df2[df2['IndicatorName'] == "HV"]["IndicatorValue"].std())
    print()
    print("GD")
    print(df2[df2['IndicatorName'] == "GD"]["IndicatorValue"].median())
    print(df2[df2['IndicatorName'] == "GD"]["IndicatorValue"].std())
    print()
    print("EP")
    print(df2[df2['IndicatorName'] == "EP"]["IndicatorValue"].median())
    print(df2[df2['IndicatorName'] == "EP"]["IndicatorValue"].std())
    print()

    print()
    print("Time")
    print(df2[df2['IndicatorName'] == "Time"]["IndicatorValue"].mean())
    print(df2[df2['IndicatorName'] == "Time"]["IndicatorValue"].std())
    print()

    print("#############")
    print("WILCOXON TEST")
    print()
    print("HV")
    res = wilcoxon(df[df['IndicatorName'] == "HV"]["IndicatorValue"], df2[df2['IndicatorName'] == "HV"]["IndicatorValue"], alternative='greater')
    print(res)
    print()
    print()
    print("GD")
    res = wilcoxon(df[df['IndicatorName'] == "GD"]["IndicatorValue"], df2[df2['IndicatorName'] == "GD"]["IndicatorValue"], alternative='less')
    print(res)
    print()
    print()
    print("EP")
    res = wilcoxon(df[df['IndicatorName'] == "EP"]["IndicatorValue"], df2[df2['IndicatorName'] == "EP"]["IndicatorValue"], alternative='less')
    print(res)
    print()

